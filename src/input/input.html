<html>
  <body>
    <!-- TODO: IF NOTHING IS WORKING USE REACTIFY (react-web-components) -->
    <!-- SOLUTIONS: BEST -> WORSE  -->
    <!-- 1. have controlled web components, state is stored in App(React) -->
    <!-- 2. have uncontrolled web components, state is stored in DOM  -->
    <!-- 3. have controlled component -->

    CONCLUSION:
    It is
    <div id="app"></div>
    <my-input value="static"></my-input>
    <script
      src="https://unpkg.com/babel-standalone@6/babel.min.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react@16/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"
      crossorigin
    ></script>

    <!-- MY-INPUT WEB COMPONENT -->
    <script>
      class MyControlledInput extends HTMLElement {
        constructor(props) {
          super(props);
          this.shadow = this.attachShadow({ mode: "open" });

          this.addEventListener("keypress", evt => {
            evt.preventDefault();
            const value = this.getAttribute("value") + evt.key;
            const customEvent = new CustomEvent("change", {
              bubbles: true,
              detail: { value }
            });

            this.dispatchEvent(customEvent);
          });
        }
        static get observedAttributes() {
          return ["value"];
        }
        attributeChangedCallback() {
          const value = this.getAttribute("value");
          this.shadowRoot.activeElement.setAttribute("value", value);
        }

        connectedCallback() {
          const value = this.getAttribute("value");
          console.log("connectedCallback", value);

          // console.log("THIS>value", value)
          this.shadow.innerHTML = `Hellol <input value="${value}"/> `;
        }
      }
      customElements.define("my-input", MyControlledInput);
    </script>

<!-- MY-UNCONTROLLED INPUT WEB COMPONENT -->
<script>
    class MyUncontrolledInput extends HTMLElement {
      constructor(props) {
        super(props);
        this.shadow = this.attachShadow({ mode: "open" });
      }

      connectedCallback() {
        this.shadow.innerHTML = `You cannot control me <input /> `;
      }
    }
    customElements.define("my-uncuntrolled-input", MyUncontrolledInput);
  </script>

    <!-- REACT APP -->
    <script type="text/babel">
      const e = React.createElement;

      class MyReactComponent extends React.Component {
        state = { value: 5 };

        componentDidMount() {
          const el = document
            .getElementById("ref")
            .addEventListener("change", evt =>
              this.setState({ value: evt.detail.value })
            );
        }

        render() {
          return (
            <div>
              <my-input
                value={this.state.value}
                id="ref"
                onChange={() => console.log("IIIK")}
              />
              <my-uncuntrolled-input/>
              {this.state.value}
            </div>
          );
        }
      }

      ReactDOM.render(
        <h1>
          Hello, world!<div>HAHHA</div>
          <MyReactComponent />
        </h1>,
        document.getElementById("app")
      );
    </script>
  </body>
</html>
