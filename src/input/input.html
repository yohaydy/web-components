<html>
  <body>
   
    <div id="app"></div>
    <my-input value="static"></my-input>
    <script
      src="https://unpkg.com/babel-standalone@6/babel.min.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react@16/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"
      crossorigin
    ></script>

    <!-- MY-INPUT WEB COMPONENT -->
    <script>
      class MyControlledInput extends HTMLElement {
        constructor(props) {
          super(props);
          this.shadow = this.attachShadow({ mode: 'open' });

          this.addEventListener('keypress', evt => {
            evt.preventDefault();
            const value = this.getAttribute('value') + evt.key;
            const customEvent = new CustomEvent('change', {
              bubbles: true,
              detail: { value },
            });

            this.dispatchEvent(customEvent);
          });
        }
        static get observedAttributes() {
          return ['value'];
        }
        attributeChangedCallback() {
          const value = this.getAttribute('value');
          this.shadowRoot.activeElement.setAttribute('value', value);
        }

        connectedCallback() {
          const value = this.getAttribute('value');
          console.log('connectedCallback', value);

          // console.log("THIS>value", value)
          this.shadow.innerHTML = `Controlled <input value="${value}"/> `;
        }
      }
      customElements.define('my-input', MyControlledInput);
    </script>

    <!-- MY-UNCONTROLLED INPUT WEB COMPONENT -->
    <script>
      class MyUncontrolledInput extends HTMLElement {
        constructor(props) {
          super(props);
          this.shadow = this.attachShadow({ mode: 'open' });
        }

        connectedCallback() {
          this.shadow.innerHTML = `You cannot control me <input id="unc" /> `;
        }
      }
      customElements.define('my-uncuntrolled-input', MyUncontrolledInput);
    </script>

    <!-- REACT APP -->
    <script type="text/babel">
      const e = React.createElement;

      class MyReactComponent extends React.Component {
        state = { value: 5 };

        componentDidMount() {
          const el = document
            .getElementById('ref')
            .addEventListener('change', evt =>
              this.setState({ value: evt.detail.value }),
            );
        }

        render() {
          return (
            <div>
              <div>
                <my-input
                  value={this.state.value}
                  id="ref"
                />
                {this.state.value}
              </div>
              <my-uncuntrolled-input id="anc" />
            </div>
          );
        }
      }

      ReactDOM.render(
        <h3>
          Hello, world!
          <MyReactComponent />
        </h3>,
        document.getElementById('app'),
      );
    </script>
  </body>
</html>
